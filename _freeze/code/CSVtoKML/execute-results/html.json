{
  "hash": "fb3585d9be2fd9ce7c056f16d2c2cde6",
  "result": {
    "markdown": "---\ntitle: \"Drifter Data - CSV to KML\"\nauthor: \"Kourtney Burger\"\ndate: \"2025-01-07\"\noutput: html_document\n---\n\n\n\n\n# Read in data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#data <- read.csv(\"GPS data/CalCurCEAS_027_GPS.csv\")\n\ncsv_files <- list.files(path = here('data/GPS/DASBRs'), pattern = \"\\\\.csv$\", full.names = TRUE)\n```\n:::\n\n\n# Create a KML document\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to create KML from multiple CSV files using xml2\ncreate_kml_from_csv <- function(csv_files, kml_output) {\n  \n  # Create an empty KML structure using xml2\n  kml_data <- xml_new_root(\"kml\", xmlns = \"http://www.opengis.net/kml/2.2\")\n  document_node <- xml_add_child(kml_data, \"Document\")\n  \n  # Loop through each CSV file\n  for (csv_file in csv_files) {\n    \n    # Read the CSV file\n    data <- read.csv(csv_file)\n    \n    # Check for required columns\n    if (!all(c(\"Latitude\", \"Longitude\", \"UTC\") %in% colnames(data))) {\n      stop(paste(\"CSV file\", csv_file, \"does not have the required columns\"))\n    }\n    \n    # Loop through each row of the CSV data\n    for (i in 1:nrow(data)) {\n      \n      # Create a placemark for each row in the CSV\n      placemark <- xml_add_child(document_node, \"Placemark\")\n      \n      # Add the name (can be based on the timestamp or other fields)\n      xml_add_child(placemark, \"name\", paste(\"Point at\", data$UTC[i]))\n      \n      # Add timestamp (convert to TimeStamp tag)\n      time_node <- xml_add_child(placemark, \"TimeStamp\")\n      xml_add_child(time_node, \"when\", data$UTC[i])\n      \n      # Add the Point and coordinates\n      point_node <- xml_add_child(placemark, \"Point\")\n      coords <- paste(data$Longitude[i], data$Latitude[i], \"0\", sep = \",\")\n      xml_add_child(point_node, \"coordinates\", coords)\n    }\n  }\n  \n  # Save the KML to the specified output file\n  write_xml(kml_data, kml_output)\n  cat(\"KML file created:\", kml_output, \"\\n\")\n}\n```\n:::\n\n\n# Test with all CalCurCEAS data\n\n-   note, this crashed Google Earth\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the path to the \"GPS data\" folder\nfolder_path <- \"GPS data\"\n\n# Get the list of CSV files in the folder\ncsv_files <- list.files(path = folder_path, pattern = \"\\\\.csv$\", full.names = TRUE)\n\n# Check the CSV files in the folder\nprint(csv_files)\n\n# Define the output KML file\nkml_output <- here('output/DASBRs.kml')\n\n# Create KML from the CSV files in the \"GPS data\" folder\ncreate_kml_from_csv(csv_files, kml_output)\n```\n:::\n\n\n# Test with Oregon Subset\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the path to the \"GPS data\" folder\nfolder_path <- \"GPS data/Oregon Subset/\"\n\n# Get the list of CSV files in the folder\ncsv_files <- list.files(path = folder_path, pattern = \"\\\\.csv$\", full.names = TRUE)\n\n# Check the CSV files in the folder\nprint(csv_files)\n\n# Define the output KML file\nkml_output <- here('output/OregonDASBRs.kml')\n\n# Create KML from the CSV files in the \"GPS data\" folder\ncreate_kml_from_csv(csv_files, kml_output)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}